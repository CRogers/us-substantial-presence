general:
  branches:
    ignore:
      - gh-pages

machine:
  pre:
    - /home/ubuntu/$CIRCLE_PROJECT_REPONAME/scripts/download-docker-compose.sh
    - docker-compose version
  environment:
    TERM: dumb
  java:
    version: oraclejdk8

dependencies:
  cache_directories:
    - ~/.gradle

test:
  pre:
    - cd frontend && ./run-with-node "echo caching"
  override:
    - cd frontend && ./tests
    - ./gradlew --continue -is etes
  post:
    - cp -r ete-tests/target/ $CIRCLE_ARTIFACTS/etes-report

deployment:
  develop:
    branch: develop
    owner: CRogers
    commands:
      - ./scripts/deploy-gh-pages.sh